<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Snakes & Ladders Game Status</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }

      #gameStatus {
        position: fixed;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        width: 300px;
        background: rgba(0, 0, 0, 0.85);
        border-radius: 10px;
        padding: 15px;
        color: white;
        display: none;
        border: 2px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      }

      .header {
        background: linear-gradient(135deg, #3498db, #2980b9);
        padding: 10px;
        border-radius: 5px;
        text-align: center;
        margin-bottom: 15px;
        font-weight: 600;
        font-size: 18px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      .player-list {
        max-height: 300px;
        overflow-y: auto;
      }

      .player {
        background: rgba(255, 255, 255, 0.1);
        margin: 5px 0;
        padding: 10px;
        border-radius: 5px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s ease;
      }

      .player-name {
        font-size: 14px;
      }

      .player-position {
        background: rgba(255, 255, 255, 0.2);
        padding: 3px 8px;
        border-radius: 10px;
        font-size: 12px;
      }

      .snake-effect {
        animation: shake 0.5s infinite;
        color: #e74c3c !important;
        text-shadow: 0 0 5px #e74c3c;
      }

      .ladder-effect {
        animation: shake 0.5s infinite;
        color: #2ecc71 !important;
        text-shadow: 0 0 5px #2ecc71;
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-2px);
        }
        75% {
          transform: translateX(2px);
        }
      }

      /* Scrollbar Styling */
      .player-list::-webkit-scrollbar {
        width: 5px;
      }

      .player-list::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 5px;
      }

      .player-list::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 5px;
      }

      /* Current player indicator */
      .current-turn {
        border: 2px solid #f1c40f;
        box-shadow: 0 0 10px rgba(241, 196, 15, 0.5);
      }

      .turn-indicator {
        background: #f1c40f;
        color: #000;
        padding: 2px 6px;
        border-radius: 3px;
        font-size: 10px;
        margin-left: 5px;
      }
    </style>
  </head>
  <body>
    <div id="gameStatus">
      <div class="header">ðŸŽ² Snakes & Ladders</div>
      <div class="player-list" id="playerList">
        <!-- Players will be added here dynamically -->
      </div>
    </div>

    <script>
      let effectTimeouts = {};

      window.addEventListener("message", function (event) {
        const data = event.data;

        switch (data.action) {
          case "showUI":
            document.getElementById("gameStatus").style.display = "block";
            break;

          case "hideUI":
            document.getElementById("gameStatus").style.display = "none";
            break;

          case "updatePlayers":
            updatePlayerList(data.players, data.currentTurn);
            break;

          case "playerEffect":
            applyPlayerEffect(data.playerId, data.effectType);
            break;
        }
      });

      function updatePlayerList(players, currentTurn) {
        const playerList = document.getElementById("playerList");
        playerList.innerHTML = "";

        players.forEach((player) => {
          const playerDiv = document.createElement("div");
          playerDiv.className = `player ${
            currentTurn === player.id ? "current-turn" : ""
          }`;
          playerDiv.id = `player-${player.id}`;

          playerDiv.innerHTML = `
                    <span class="player-name">${player.name} 
                        ${
                          currentTurn === player.id
                            ? '<span class="turn-indicator">TURN</span>'
                            : ""
                        }
                    </span>
                    <span class="player-position">Position: ${
                      player.position
                    }</span>
                `;

          playerList.appendChild(playerDiv);
        });
      }

      function applyPlayerEffect(playerId, effectType) {
        const playerElement = document.getElementById(`player-${playerId}`);
        if (!playerElement) return;

        // Clear existing effect if any
        if (effectTimeouts[playerId]) {
          clearTimeout(effectTimeouts[playerId]);
          playerElement.classList.remove("snake-effect", "ladder-effect");
        }

        // Apply new effect
        playerElement.classList.add(`${effectType}-effect`);

        // Remove effect after 2 seconds
        effectTimeouts[playerId] = setTimeout(() => {
          playerElement.classList.remove(`${effectType}-effect`);
          delete effectTimeouts[playerId];
        }, 2000);
      }
    </script>
  </body>
</html>
