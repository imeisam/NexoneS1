import{s as $,j as e,x as h,U as K,G as k,T as A,a9 as Q,h as p,aa as W,ab as Y,ac as J,R as P,L as V,ad as X,P as L,r as m,ae as ee,v as F,A as q,af as se,ag as te,I as ae,E as H,H as re,y as O,ah as oe,a6 as ne,B,ai as ce,aj as le,K as ie,M as de,a8 as he,F as me,w as C}from"./index-BqdSnAGD.js";import{G as M}from"./Grid-mMBQLcX1.js";/**
 * @license @tabler/icons-react v3.7.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ue=$("filled","photo-filled","IconPhotoFilled",[["path",{d:"M8.813 11.612c.457 -.38 .918 -.38 1.386 .011l.108 .098l4.986 4.986l.094 .083a1 1 0 0 0 1.403 -1.403l-.083 -.094l-1.292 -1.293l.292 -.293l.106 -.095c.457 -.38 .918 -.38 1.386 .011l.108 .098l4.674 4.675a4 4 0 0 1 -3.775 3.599l-.206 .005h-12a4 4 0 0 1 -3.98 -3.603l6.687 -6.69l.106 -.095zm9.187 -9.612a4 4 0 0 1 3.995 3.8l.005 .2v9.585l-3.293 -3.292l-.15 -.137c-1.256 -1.095 -2.85 -1.097 -4.096 -.017l-.154 .14l-.307 .306l-2.293 -2.292l-.15 -.137c-1.256 -1.095 -2.85 -1.097 -4.096 -.017l-.154 .14l-5.307 5.306v-9.585a4 4 0 0 1 3.8 -3.995l.2 -.005h12zm-2.99 5l-.127 .007a1 1 0 0 0 0 1.986l.117 .007l.127 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.7.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var xe=$("filled","user-filled","IconUserFilled",[["path",{d:"M12 2a5 5 0 1 1 -5 5l.005 -.217a5 5 0 0 1 4.995 -4.783z",key:"svg-0"}],["path",{d:"M14 14a5 5 0 0 1 5 5v1a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-1a5 5 0 0 1 5 -5h4z",key:"svg-1"}]]);const _e="_table_1oizw_1",pe="_th_1oizw_11",fe="_td_1oizw_31",ge="_tr_1oizw_51",je="_control_1oizw_59",we="_icon_1oizw_81",ve="_input_1oizw_93",be="_label_1oizw_107",ye="_Invite_1oizw_127",Se="_header_1oizw_139",ze="_scrolled_1oizw_167",Ce="_positions_1oizw_175",Ne="_scrollbar_1oizw_187",Ie="_thumb_1oizw_189",r={table:_e,th:pe,td:fe,tr:ge,control:je,icon:we,input:ve,label:be,Invite:ye,header:Se,scrolled:ze,positions:Ce,scrollbar:Ne,thumb:Ie},R=({type:o,children:c,reversed:t,sorted:n,onSort:x})=>{const _=n?t?W:Y:J;return e.jsx(h.Th,{className:r.th,style:{borderRight:o=="crew"?"1px solid rgba(255, 255, 255, 0.12)":"unset"},children:e.jsx(K,{onClick:x,className:r.control,children:e.jsxs(k,{justify:"space-between",children:[e.jsx(A,{fw:500,fz:"sm",children:c}),e.jsx(Q,{className:r.icon,children:e.jsx(_,{style:{width:p(16),height:p(16)},stroke:1.5})})]})})})};function Te(o,c){const t=c.toLowerCase().trim();return o.filter(n=>Object.values(n).some(x=>typeof x=="string"&&x.toLowerCase().includes(t)))}function U(o,c){const{sortBy:t,reversed:n,search:x}=c,_=Te(o,x);return t?[..._].sort((a,d)=>typeof a[t]=="string"&&typeof d[t]=="string"?n?d[t].localeCompare(a[t]):a[t].localeCompare(d[t]):typeof a[t]=="number"&&typeof d[t]=="number"?n?d[t]-a[t]:a[t]-d[t]:0):_}const Be=({members:o,currentPage:c,setCurrentPage:t,setTotal:n,handleInvite:x,handleEdit:_,handleFire:b})=>{const a=P(V),d=X(),{crew:N}=P(L),[j,w]=m.useState(!1),[I,D]=m.useState(""),[y,S]=m.useState(o),[f,l]=m.useState(null),[i,z]=m.useState(!1),[v,T]=m.useState(9),E=s=>{const u=s===f?!i:!1;z(u),l(s),S(U(o,{sortBy:s,reversed:u,search:I}))},Z=s=>{const{value:u}=s.currentTarget;D(u),S(U(o,{sortBy:f,reversed:i,search:u})),t(1)},G=y.slice((c-1)*v,c*v).map(s=>e.jsxs(h.Tr,{classNames:r,children:[e.jsx(h.Td,{classNames:r,style:{borderLeft:"1px solid rgba(255, 255, 255, 0.12)"},children:e.jsx(ee,{size:32,src:s.photo,radius:0})}),e.jsx(h.Td,{classNames:r,children:s.name}),e.jsx(h.Td,{classNames:r,children:s.races}),e.jsx(h.Td,{classNames:r,children:s.wins}),e.jsx(h.Td,{classNames:r,style:{borderRight:"1px solid rgba(255, 255, 255, 0.12)"},children:e.jsx(e.Fragment,{children:N&&N.isBoss?e.jsx(e.Fragment,{children:e.jsxs(k,{gap:4,justify:"center",children:[s.isBoss?e.jsx(F,{label:a.remove_boss,color:"dark.5",children:e.jsx(q,{variant:"transparent",color:"rgb(237,237,237)",onClick:u=>{u.stopPropagation(),_(s.identifier,0)},children:e.jsx(te,{size:16})})}):e.jsx(F,{label:a.set_boss,color:"dark.5",children:e.jsx(q,{variant:"transparent",color:"rgb(237,237,237)",onClick:u=>{u.stopPropagation(),_(s.identifier,1)},children:e.jsx(se,{size:16})})}),e.jsx(F,{label:a.remove_member,color:"dark.5",children:e.jsx(q,{variant:"transparent",color:"rgb(237,237,237)",onClick:u=>{u.stopPropagation(),b(s.identifier)},children:e.jsx(ae,{size:16})})})]})}):null})})]},s.identifier));return m.useEffect(()=>{S(o)},[o]),m.useEffect(()=>{let s=1;d>500&&(s=2,T(s)),d>750&&(s=6,T(s)),d>800&&(s=7,T(s)),d>900&&(s=9,T(s)),n(Math.ceil(y.length/s))},[y.length]),e.jsxs(e.Fragment,{children:[e.jsxs(k,{w:"100%",grow:!0,mb:"sm",children:[e.jsx(H,{classNames:r,placeholder:a.search,maw:"100%",mr:6,radius:0,leftSection:e.jsx(re,{style:{width:p(16),height:p(16)},stroke:1.5}),value:I,onChange:Z}),e.jsx(O,{className:r.Invite,maw:"fit-content",color:"#262626",c:"rgba(237, 237, 237, 1)",onClick:x,children:a.invite})]}),e.jsx(oe,{className:r.positions,classNames:r,onScrollPositionChange:({y:s})=>w(s!==0),children:e.jsxs(h,{layout:"fixed",classNames:r,children:[e.jsx(h.Thead,{className:ne(r.header,{[r.scrolled]:j}),bg:"#262626",children:e.jsxs(h.Tr,{className:r.tr,children:[e.jsx(h.Th,{w:70,style:{borderLeft:"1px solid rgba(255, 255, 255, 0.12)"}}),e.jsx(R,{type:"name",sorted:f==="name",reversed:i,onSort:()=>E("name"),children:a.username}),e.jsx(R,{type:"races",sorted:f==="races",reversed:i,onSort:()=>E("races"),children:a.total_races}),e.jsx(R,{type:"wins",sorted:f==="wins",reversed:i,onSort:()=>E("wins"),children:a.races_won}),e.jsx(h.Th,{style:{borderRight:"1px solid rgba(255, 255, 255, 0.12)"},children:a.actions})]})}),e.jsx(h.Tbody,{className:r.body,children:G.length>0?G:null})]})})]})},ke="_footer_h4qmt_11",Pe="_control_h4qmt_27",De="_input_h4qmt_41",Ee="_crewBox_h4qmt_55",Fe="_crewName_h4qmt_69",qe="_racers_h4qmt_85",Me="_save_h4qmt_111",g={footer:ke,control:Pe,input:De,crewBox:Ee,crewName:Fe,racers:qe,save:Me},Re=({page:o,setCurrentPage:c,total:t})=>e.jsx(B,{className:g.footer,ml:"auto",w:"98%",p:"xs",children:e.jsx(ce,{value:o,classNames:g,total:t,size:"xs",ml:"auto",radius:0,color:"rgba(205, 207, 102, 1)",autoContrast:!0,mt:"sm",onChange:c})}),Ue=()=>{const o=P(V),[c,t]=le(L),{crew:n}=P(L),[x,_]=m.useState(ie()),[b,a]=m.useState(1),[d,N]=m.useState(0),[j,w]=m.useState([]),I=async()=>{const l=await C("av_racing","inviteCrew",n);l&&w(l)},D=(l,i)=>{const z=j.map(v=>v.identifier===l?{...v,isBoss:i}:v);w(z),C("av_racing","changeBoss",{identifier:l,value:i})},y=l=>{const i=j.filter(z=>z.identifier!==l);w(i),C("av_racing","fireMember",l)},S=l=>{if(c.crew&&typeof c.crew!="boolean"){const i={...c,crew:{...c.crew,photo:l}};t(i)}},f=()=>{C("av_racing","updateCrew",n)};return m.useEffect(()=>{(async()=>{const i=await C("av_racing","getCrew",n.name);i&&(w(i),setTimeout(()=>{_(!0)},100))})()},[]),x?e.jsxs(B,{p:"md",children:[e.jsxs(M,{grow:!0,children:[e.jsx(M.Col,{span:"auto",children:e.jsxs(B,{className:g.crewBox,children:[e.jsxs(k,{grow:!0,gap:"auto",children:[e.jsx(he,{src:n.photo,mah:130,maw:130,fallbackSrc:"https://r2.fivemanage.com/QmVAYSlqeAlD4IxVbdvu5/p0oT829.png"}),e.jsxs(me,{direction:"column",w:140,children:[e.jsx(A,{className:g.crewName,truncate:!0,children:n.label}),e.jsxs(B,{className:g.racers,children:[e.jsx(xe,{style:{width:p(18),height:p(18)}}),e.jsx(A,{ml:2,fz:"xs",children:`${j.length} ${o.members}`})]})]})]}),e.jsx(H,{mt:"sm",size:"sm",classNames:g,radius:0,placeholder:o.photo,value:n.photo,onChange:l=>{S(l.target.value)},leftSection:e.jsx(ue,{style:{color:"rgba(255,255,255,0.3)",width:p(18),height:p(18)}}),disabled:!n.isBoss}),e.jsx(O,{mt:"sm",fullWidth:!0,radius:0,className:g.save,size:"sm",color:"rgba(205, 207, 102, 1)",c:"black",style:{zIndex:"99"},disabled:!n.isBoss,onClick:f,children:o.save})]})}),e.jsx(M.Col,{span:7,children:e.jsx(Be,{handleInvite:I,handleEdit:D,handleFire:y,members:j,currentPage:b,setCurrentPage:a,setTotal:N})})]}),e.jsx(Re,{page:b,setCurrentPage:a,total:d})]}):e.jsx(de,{})};export{Ue as default};
