import{z as $,b as F,n as Q,j as e,B as j,p as U,q as me,C as ve,e as fe,r,D as ge,s as A,R as N,L as B,G as k,T as y,F as E,v as D,A as L,I as be,E as ye,H as _e,h as V,y as je,S as X,J as we,x as ke,K as Ce,P as Se,M as Ne,w as S}from"./index-BqdSnAGD.js";import{B as Me,G as W,M as Te}from"./ModalMenu-C9yI5ldG.js";import{G as K}from"./Grid-mMBQLcX1.js";import"./Textarea-Dsf_KKuD.js";var Y={root:"m_1b7284a3"};const Re={},De=U((a,{radius:n,shadow:s})=>({root:{"--paper-radius":n===void 0?void 0:me(n),"--paper-shadow":ve(s)}})),O=$((a,n)=>{const s=F("Paper",Re,a),{classNames:u,className:m,style:v,styles:c,unstyled:p,withBorder:o,vars:i,radius:_,shadow:h,variant:d,mod:b,...C}=s,f=Q({name:"Paper",props:s,classes:Y,className:m,style:v,classNames:u,styles:c,unstyled:p,vars:i,varsResolver:De});return e.jsx(j,{ref:n,mod:[{"data-with-border":o},b],...f("root"),variant:d,...C})});O.classes=Y;O.displayName="@mantine/core/Paper";const[Le,Ae]=fe("Card component was not found in tree");var G={root:"m_e615b15f",section:"m_599a2148"};const Be={},z=$((a,n)=>{const s=F("CardSection",Be,a),{classNames:u,className:m,style:v,styles:c,vars:p,withBorder:o,inheritPadding:i,mod:_,...h}=s,d=Ae();return e.jsx(j,{ref:n,mod:[{"with-border":o,"inherit-padding":i},_],...d.getStyles("section",{className:m,style:v,styles:c,classNames:u}),...h})});z.classes=G;z.displayName="@mantine/core/CardSection";const ze={},Ie=U((a,{padding:n})=>({root:{"--card-padding":ge(n)}})),w=$((a,n)=>{const s=F("Card",ze,a),{classNames:u,className:m,style:v,styles:c,unstyled:p,vars:o,children:i,padding:_,...h}=s,d=Q({name:"Card",props:s,classes:G,className:m,style:v,classNames:u,styles:c,unstyled:p,vars:o,varsResolver:Ie}),b=r.Children.toArray(i),C=b.map((f,M)=>typeof f=="object"&&f&&"type"in f&&f.type===z?r.cloneElement(f,{"data-first-section":M===0||void 0,"data-last-section":M===b.length-1||void 0}):f);return e.jsx(Le,{value:{getStyles:d},children:e.jsx(O,{ref:n,unstyled:p,...d("root"),...h,children:C})})});w.classes=G;w.displayName="@mantine/core/Card";w.Section=z;/**
 * @license @tabler/icons-react v3.7.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Pe=A("outline","award","IconAward",[["path",{d:"M12 9m-6 0a6 6 0 1 0 12 0a6 6 0 1 0 -12 0",key:"svg-0"}],["path",{d:"M12 15l3.4 5.89l1.598 -3.233l3.598 .232l-3.4 -5.889",key:"svg-1"}],["path",{d:"M6.802 12l-3.4 5.89l3.598 -.233l1.598 3.232l3.4 -5.889",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.7.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ee=A("outline","calendar-event","IconCalendarEvent",[["path",{d:"M4 5m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M16 3l0 4",key:"svg-1"}],["path",{d:"M8 3l0 4",key:"svg-2"}],["path",{d:"M4 11l16 0",key:"svg-3"}],["path",{d:"M8 15h2v2h-2z",key:"svg-4"}]]);/**
 * @license @tabler/icons-react v3.7.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var $e=A("outline","map-search","IconMapSearch",[["path",{d:"M11 18l-2 -1l-6 3v-13l6 -3l6 3l6 -3v7.5",key:"svg-0"}],["path",{d:"M9 4v13",key:"svg-1"}],["path",{d:"M15 7v5",key:"svg-2"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-3"}],["path",{d:"M20.2 20.2l1.8 1.8",key:"svg-4"}]]);/**
 * @license @tabler/icons-react v3.7.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fe=A("outline","steering-wheel","IconSteeringWheel",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M12 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M12 14l0 7",key:"svg-2"}],["path",{d:"M10 12l-6.75 -2",key:"svg-3"}],["path",{d:"M14 12l6.75 -2",key:"svg-4"}]]);const Oe="_flagBox_oeva4_19",Ge="_title_oeva4_47",qe="_subheader_oeva4_63",He="_input_oeva4_85",Je="_label_oeva4_99",Ve="_dropdown_oeva4_119",We="_trackCard_oeva4_131",Ke="_trackName_oeva4_153",Qe="_badge_oeva4_169",Ue="_description_oeva4_187",Xe="_distance_oeva4_201",Ye="_distanceData_oeva4_219",Ze="_container_oeva4_237",x={flagBox:Oe,title:Ge,subheader:qe,input:He,label:Je,dropdown:Ve,trackCard:We,trackName:Ke,badge:Qe,description:Ue,distance:Xe,distanceData:Ye,container:Ze},ea=({track:a,serial:n,deleteTrack:s,handlePreview:u,createEvent:m,createRace:v,handleDelete:c,handleLeaderboard:p})=>{const o=N(B);return e.jsxs(w,{padding:"10px",radius:"sm",className:x.trackCard,children:[e.jsx(w.Section,{p:"xs",children:e.jsxs(k,{justify:"space-between",children:[e.jsx(y,{fw:500,truncate:!0,w:150,className:x.trackName,children:a.name}),e.jsx(Me,{variant:"light",color:a.color?`${a.color}`:"blue",className:x.badge,children:a.type?e.jsx(e.Fragment,{children:a.type}):e.jsx(e.Fragment,{children:o.default_type})})]})}),e.jsx(w.Section,{maw:"100%",mah:54,style:{overflow:"auto",marginLeft:"1px"},children:e.jsx(y,{className:x.description,children:a.description})}),e.jsx(w.Section,{style:{display:"inline-flex",position:"absolute",bottom:"0",padding:"10px",justifyContent:"space-between",width:"100%",marginBottom:"-5px"},children:e.jsxs(k,{w:"100%",children:[e.jsx(j,{style:{display:"flex",margin:"auto",marginLeft:"0"},children:e.jsx(k,{gap:2,children:e.jsxs(E,{direction:"column",children:[e.jsx(y,{className:x.distance,children:o.distance}),e.jsx(y,{className:x.distanceData,children:`${a.distance} ${o.distance_unit}`})]})})}),e.jsx(j,{ml:"auto",children:e.jsxs(E,{gap:"5px",justify:"flex-start",align:"center",direction:"row",wrap:"wrap",children:[e.jsx(D,{label:o.preview,color:"dark.4",fz:"xs",withArrow:!0,children:e.jsx(L,{size:"sm",p:2,variant:"filled",color:"rgba(56, 56, 56, 1)",c:"gray",style:{borderRadius:"0px"},onClick:()=>{u(a.checkpoints)},children:e.jsx($e,{style:{width:14,height:14}})})}),v&&e.jsx(D,{label:o.create_event,color:"dark.4",fz:"xs",withArrow:!0,children:e.jsx(L,{size:"sm",p:2,variant:"filled",color:"rgba(56, 56, 56, 1)",c:"gray",style:{borderRadius:"0px"},onClick:()=>{m(a)},children:e.jsx(Ee,{style:{width:14,height:14}})})}),e.jsx(D,{label:o.leaderboard_tab,color:"dark.4",fz:"xs",withArrow:!0,children:e.jsx(L,{size:"sm",p:2,variant:"filled",color:"rgba(56, 56, 56, 1)",c:"gray",style:{borderRadius:"0px"},onClick:()=>{p(a)},children:e.jsx(Pe,{style:{width:14,height:14}})})}),n==a.createdby||s?e.jsx(e.Fragment,{children:e.jsx(D,{label:o.delete_track,color:"dark.4",fz:"xs",withArrow:!0,children:e.jsx(L,{size:"sm",p:2,variant:"filled",color:"rgba(56, 56, 56, 1)",c:"gray",style:{borderRadius:"0px"},onDoubleClick:()=>{c(a.identifier)},children:e.jsx(be,{style:{width:14,height:14}})})})}):null]})})]})})]})},aa=({options:a,count:n,handleSearch:s,handleFilter:u,handleNew:m,createTracks:v})=>{const c=N(B);return e.jsxs(k,{className:x.header,children:[e.jsxs(k,{children:[e.jsx(j,{className:x.flagBox,children:e.jsx(Fe,{style:{width:"50%",height:"50%"}})}),e.jsxs(E,{gap:"0px",direction:"column",mt:3,children:[e.jsxs(y,{className:x.title,children:[c.header_explore," ",e.jsx("a",{style:{color:"rgba(205, 207, 102, 1)"},children:n})," ",c.header_tracks]}),e.jsx(y,{className:x.subheader,children:c.subheader})]})]}),e.jsxs(k,{ml:"auto",gap:"xs",children:[e.jsx(ye,{classNames:x,radius:0,placeholder:c.search,leftSection:e.jsx(_e,{style:{width:V(12),height:V(12)}}),onChange:p=>{s(p.target.value)}}),v&&e.jsx(je,{color:"rgba(25, 25, 25, 1)",radius:0,classNames:x,style:{border:"1px solid rgba(255, 255, 255, 0.36)"},onClick:m,children:c.create_track}),e.jsx(X,{classNames:x,ta:"center",data:a,defaultValue:"all",radius:0,w:120,allowDeselect:!1,onChange:p=>{u(p)}})]})]})},ta="_container_1dntw_11",sa="_box_1dntw_31",ra="_modalOptions_1dntw_71",na="_tr_1dntw_85",la="_input_1dntw_97",P={container:ta,box:sa,modalOptions:ra,tr:na,input:la};function oa(a){return a.sort((n,s)=>n.miliseconds-s.miliseconds)}const ca=({data:a,setShowLeaderboard:n})=>{const s=N(B),[u,m]=r.useState([]),[v,c]=r.useState([]),[p,o]=r.useState(!1),i=h=>{if(!h)return;const d=a[h.toLowerCase()]||[],b=oa(d);m(b)},_=we(()=>{p||n(!1)});return r.useEffect(()=>{const h=u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(y,{fz:"xs",truncate:!0,maw:120,children:d.name})}),e.jsx("td",{children:e.jsx(y,{fz:"xs",truncate:!0,maw:120,children:d.vehicle})}),e.jsx("td",{children:d.bestTime}),e.jsx("td",{children:d.crew?d.crew:" "})]},d.name));c(h)},[u]),e.jsx(j,{className:P.container,children:e.jsxs(j,{className:P.box,ref:_,children:[e.jsx(y,{fz:22,style:{width:"100%",textAlign:"center"},c:"rgba(205, 207, 102, 1)",children:s.best_times}),e.jsx(X,{classNames:P,mt:4,label:s.vehicle_class,data:[{value:"m",label:"M"},{value:"d",label:"D"},{value:"c",label:"C"},{value:"b",label:"B"},{value:"a",label:"A"},{value:"a+",label:"A+"},{value:"s",label:"S"},{value:"s+",label:"S+"}],onChange:i,onDropdownOpen:()=>{o(!0)},onDropdownClose:()=>{o(!1)},size:"xs"}),e.jsxs(ke,{mt:"sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s.username}),e.jsx("th",{children:s.vehicle}),e.jsx("th",{children:s.best_lap}),e.jsx("th",{children:s.crew})]})}),e.jsx("tbody",{children:v})]})]})})},ha=()=>{const a=N(B),[n,s]=r.useState(Ce()),[u,m]=r.useState(!1),[v,c]=r.useState(!1),[p,o]=r.useState(!1),[i,_]=r.useState([]),[h,d]=r.useState([]),[b,C]=r.useState([]),[f,M]=r.useState([]),{settings:Z}=N(Se),[ee,T]=r.useState(i),[ae,I]=r.useState(!1),[te,q]=r.useState({}),[se,H]=r.useState(!1),[re,ne]=r.useState({}),[le,oe]=r.useState(0),ce=t=>{const l=i.filter(g=>t==""?i:g.name.toLowerCase().includes(t.toLowerCase()));T(l)},ie=t=>{const l=i.filter(g=>{var R;return t=="all"?i:(R=g==null?void 0:g.type)==null?void 0:R.toLowerCase().includes(t.toLowerCase())});T(l)},de=t=>{S("av_racing","preview",{checkpoints:t,settings:Z})},pe=t=>{q({title:a.create_event_title,options:[{name:"title",icon:"fa-solid fa-file-lines",title:a.event_name,type:"text",asterisk:!0},{name:"password",icon:"fa-solid fa-key",title:a.event_password,type:"password"},{name:"startsin",icon:"fa-regular fa-clock",title:a.event_startsin,type:"number",asterisk:!0},{name:"buyin",icon:"fa-solid fa-sack-dollar",title:a.event_buyin,type:"number",asterisk:!0},{name:"moneyAccount",icon:"fa-brands fa-ethereum",title:a.account,type:"select",asterisk:!0,options:f},{name:"laps",icon:"fa-solid fa-flag-checkered",title:a.event_laps,type:"number",default:0,asterisk:!0},{name:"class",title:a.event_class,type:"select",asterisk:!0,max:1,searchable:!1,options:[{value:"all",label:"All"},{value:"m",label:"M"},{value:"d",label:"D"},{value:"c",label:"C"},{value:"b",label:"B"},{value:"a",label:"A"},{value:"a+",label:"A+"},{value:"s",label:"S"},{value:"s+",label:"S+"}]},{name:"phasing",icon:"fa-solid fa-ghost",title:a.phasing,type:"select",max:1,searchable:!1,options:[{value:"10",label:"10s"},{value:"30",label:"30s"},{value:"60",label:"60s"},{value:"full",label:a.phasing_on}]},{name:"type",title:a.event_type,type:"select",asterisk:!0,searchable:!0,options:b},{name:"description",icon:"fa-regular fa-pen-to-square",label:a.event_description,type:"textarea",asterisk:!1}],button:a.confirm_button,extraData:{event:"newRace",track:t},callback:J}),I(!0)},ue=()=>{q({title:a.create_track,options:[{name:"title",title:a.track_name,type:"text",asterisk:!0,span:5},{name:"type",title:a.track_type,type:"select",asterisk:!0,searchable:!0,options:b,span:5},{name:"description",label:a.track_description,type:"textarea",asterisk:!0,span:10}],button:a.confirm_button,extraData:{event:"createTrack"},callback:J}),I(!0)},J=async t=>{I(!1),t&&S("av_racing",t.extraData.event,t)},he=t=>{if(i.find(g=>g.identifier===t)){const g=i.filter(R=>R.identifier!==t);_(g),T(g),S("av_racing","deleteTrack",t)}},xe=t=>{if(t.leaderboard){const l=JSON.parse(t.leaderboard);ne(l),H(!0)}else S("av_racing","noRecords")};return r.useEffect(()=>{(async()=>{const l=await S("av_racing","getTracks");l&&(m(l.createTracks),c(l.deleteTracks),o(l.createRaces),_(l.tracks),T(l.tracks),d(l.filtered),C(l.categories),M(l.accounts),setTimeout(()=>{s(!0)},100))})()},[]),r.useEffect(()=>{let t=0;i.forEach(l=>{W(l.type,h)&&t++}),oe(t)},[i,h]),n?e.jsxs(e.Fragment,{children:[ae&&e.jsx(Te,{data:te}),se&&e.jsx(ca,{data:re,setShowLeaderboard:H}),e.jsxs(j,{p:"md",children:[e.jsx(aa,{count:le,options:h,handleSearch:ce,handleFilter:ie,handleNew:ue,createTracks:u}),e.jsx(K,{className:x.container,mt:"md",children:ee.map((t,l)=>e.jsx(e.Fragment,{children:W(t.type,h)?e.jsx(K.Col,{span:"auto",maw:280,children:e.jsx(ea,{track:t,lang:a,deleteTrack:v,handleDelete:he,createRace:p,handlePreview:de,createEvent:pe,handleLeaderboard:xe},l)}):null}))})]})]}):e.jsx(Ne,{})};export{ha as default};
